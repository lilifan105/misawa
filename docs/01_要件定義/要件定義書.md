# 文書管理システム 要件定義書

## 1. システム概要

### 1.1 システム名
文書配信管理システム

### 1.2 目的
組織内の通達文書・連絡文書・ライブラリ文書の登録・公開・検索を効率化し、情報共有を促進する

### 1.3 対象ユーザー
- 一般社員（閲覧者）
- 部門担当者（投稿者）
- 承認者
- システム管理者

---

## 2. 主要機能一覧

### 2.1 文書管理機能
- 文書の登録、編集、削除、閲覧
- 文書カテゴリ分類（通達、連絡、ライブラリ）
- 添付ファイル管理（複数ファイル対応）
- 版管理機能

### 2.2 検索機能
- タイトル検索（部分一致）
- カテゴリ別検索
- 日付範囲検索（登録日、公開日）
- 発番部署検索
- 文書番号検索
- 複合条件検索

### 2.3 権限管理機能
- ユーザー認証
- 役割ベースアクセス制御
- 部署・グループ別アクセス制御
- 文書単位の公開範囲設定

### 2.4 ワークフロー機能
- 文書承認フロー
- ステータス管理
- 承認者への通知
- 差し戻し機能

### 2.5 公開管理機能
- 公開日時設定
- 公開期限設定
- 自動公開/非公開化
- 公開範囲設定

### 2.6 通知機能
- 新規文書公開通知
- 承認依頼通知
- 期限切れアラート

### 2.7 履歴管理機能
- 閲覧履歴記録
- 更新履歴記録
- 操作ログ記録

---

## ユースケース図

![ユースケース図](要件定義書/ユースケース図.png)

---

## 3. ユースケース定義

### UC-01: 文書を検索する

**アクター**: 一般ユーザー

**前提条件**: システムにログイン済み

**基本フロー**:
1. ユーザーが文書配信管理画面にアクセス
2. 左側のカテゴリツリーから対象カテゴリを選択（通達/連絡/ライブラリ）
3. 検索条件を入力（タイトル、日付範囲等）
4. 「絞り込み」ボタンをクリック
5. システムが条件に合致する文書一覧を表示
6. ユーザーが目的の文書を特定

**代替フロー**:
- 3a. 検索条件を指定せず全件表示
- 5a. 該当文書が0件の場合、メッセージ表示

**事後条件**: 検索結果が一覧表示される

---

### UC-02: 文書を閲覧する

**アクター**: 一般ユーザー

**前提条件**: 文書一覧が表示されている

**基本フロー**:
1. ユーザーが一覧から文書タイトルをクリック
2. システムが文書詳細画面を表示
3. ユーザーが文書内容を確認
4. 必要に応じて添付ファイルをダウンロード
5. 閲覧完了後、一覧に戻る

**代替フロー**:
- 2a. 閲覧権限がない場合、エラーメッセージ表示
- 4a. 添付ファイルが存在しない場合、ダウンロードボタン非表示

**事後条件**: 文書内容が閲覧され、閲覧履歴が記録される

---

### UC-03: 文書を新規登録する

**アクター**: 文書管理者、部門担当者

**前提条件**: 文書登録権限を持つユーザーがログイン済み

**基本フロー**:
1. ユーザーが「新規登録」ボタンをクリック
2. システムが文書登録画面を表示
3. ユーザーが必須項目を入力
   - 文書カテゴリ（通達/連絡/ライブラリ）
   - タイトル
   - 発番部署
   - 文書番号（発番部署による採番）
   - 重要度（通常/重要/緊急）
   - 公開日、公開期限
   - 公開範囲（部署、グループ）
   - 備考（任意）
4. PDFファイルをアップロード（必須、複数可）
5. 「登録」ボタンをクリック
6. システムが入力内容を検証
7. 文書を下書き保存または承認申請
8. 確認メッセージを表示

**代替フロー**:
- 6a. 必須項目未入力の場合、エラーメッセージ表示
- 7a. 「下書き保存」を選択した場合、下書きステータスで保存
- 7b. 承認フローが必要な場合、承認者に通知

**事後条件**: 文書が登録され、指定ステータスで保存される

---

### UC-04: 文書を編集する

**アクター**: 文書管理者、文書作成者

**前提条件**: 編集権限を持つユーザーがログイン済み

**基本フロー**:
1. ユーザーが文書詳細画面で「編集」ボタンをクリック
2. システムが編集画面を表示（登録時と同様の画面）
3. ユーザーが内容を修正
4. 「更新」ボタンをクリック
5. システムが変更内容を保存
6. 確認メッセージを表示し、詳細画面に戻る

**代替フロー**:
- 1a. 編集権限がない場合、編集ボタン非表示
- 1b. 公開中の文書を編集する場合、版管理を実施

**事後条件**: 文書が更新され、更新履歴が記録される

---

### UC-05: 文書を承認する

**アクター**: 承認者

**前提条件**: 承認権限を持つユーザーがログイン済み

**基本フロー**:
1. 承認者が承認待ち文書一覧を表示
2. 対象文書を選択し、内容を確認
3. 「承認」または「差し戻し」を選択
4. コメントを入力（任意）
5. 決定ボタンをクリック
6. システムがステータスを更新
7. 申請者に結果を通知

**代替フロー**:
- 3a. 差し戻しの場合、文書は下書きステータスに戻る
- 6a. 承認の場合、公開日に自動公開

**事後条件**: 文書のステータスが更新され、関係者に通知される

---

## 文書承認ワークフロー

![ワークフロー図](要件定義書/ワークフロー図.png)

---

### UC-06: 文書を削除する

**アクター**: 文書管理者

**前提条件**: 削除権限を持つユーザーがログイン済み

**基本フロー**:
1. ユーザーが文書詳細画面で「削除」ボタンをクリック
2. システムが確認ダイアログを表示
3. ユーザーが削除を確定
4. システムが文書を論理削除
5. 一覧画面に戻り、確認メッセージを表示

**代替フロー**:
- 3a. キャンセルした場合、削除せず詳細画面に戻る
- 4a. 公開中の文書は即座に非公開化

**事後条件**: 文書が削除され、一覧から非表示になる

---

### UC-07: 文書公開状況を管理する

**アクター**: 文書管理者

**前提条件**: 管理者権限でログイン済み

**基本フロー**:
1. 管理者が文書一覧でステータスを確認
2. 公開期限切れ文書を特定
3. 必要に応じて公開期限を延長または非公開化
4. システムが自動的に公開期限到達時に非公開化

**代替フロー**:
- 4a. 公開予定日到達時に自動公開

**事後条件**: 文書の公開状態が適切に管理される

---

## 4. 機能要件

### FR-01: 文書管理機能
- 文書の登録、編集、削除、閲覧
- 文書カテゴリ分類（通達、連絡、ライブラリ）
- PDFファイル管理（複数ファイル対応）
- 版管理機能
- 重要度設定（通常、重要、緊急）
- 既読/未読管理

### FR-02: 検索機能
- タイトル検索（部分一致）
- カテゴリ別検索
- 日付範囲検索（登録日、公開日）
- 発番部署検索
- 文書番号検索
- 複合条件検索

### FR-03: 権限管理機能
- ユーザー認証
- 役割ベースアクセス制御（閲覧者、投稿者、承認者、管理者）
- 部署・グループ別アクセス制御
- 文書単位の公開範囲設定

### FR-04: ワークフロー機能
- 文書承認フロー
- ステータス管理（下書き、承認待ち、承認済み、公開中、期限切れ）
- 承認者への通知
- 差し戻し機能

### FR-05: 公開管理機能
- 公開日時設定
- 公開期限設定
- 自動公開/非公開化
- 公開範囲設定

### FR-06: 通知機能
- 新規文書公開通知
- 承認依頼通知
- 期限切れアラート

### FR-07: 履歴管理機能
- 閲覧履歴記録
- 更新履歴記録
- 操作ログ記録

---

## 5. 非機能要件

### NFR-01: 性能要件
- 検索応答時間: 3秒以内（1000件まで）
- 同時アクセス: 100ユーザー
- PDFアップロード: 最大50MB/ファイル、最大10ファイル/文書
- PDFプレビュー表示: 2秒以内

### NFR-02: セキュリティ要件
- SSL/TLS通信
- パスワード暗号化保存
- セッション管理
- 不正アクセス防止
- ファイルウイルスチェック

### NFR-03: 可用性要件
- 稼働率: 99%以上（営業時間内）
- バックアップ: 日次自動バックアップ
- データ保持期間: 5年

### NFR-04: ユーザビリティ要件
- 直感的なUI設計
- レスポンシブデザイン（PC、タブレット対応）
- ブラウザ対応: Chrome, Edge, Firefox最新版

### NFR-05: 保守性要件
- エラーログ出力
- 管理者向け操作マニュアル
- ユーザー向け利用マニュアル

### NFR-06: 互換性要件
- 既存Active Directory連携
- 既存ファイルサーバー連携
- メール通知システム連携

---

## 6. データモデル（ER図）

![ER図](要件定義書/ER図.png)

---

## 6. データ要件

### 6.1 主要エンティティ

#### 文書マスタ
| 項目 | 型 | 必須 | 説明 |
|------|------|------|------|
| 文書ID | 数値 | ○ | 主キー |
| 文書番号 | 文字列(20) | ○ | 発番部署による管理番号（例：25001） |
| タイトル | 文字列(200) | ○ | 文書タイトル |
| カテゴリ | 文字列(20) | ○ | 通達/連絡/ライブラリ |
| 重要度 | 文字列(10) | ○ | 通常/重要/緊急 |
| ステータス | 文字列(20) | ○ | 下書き/承認待ち/公開中/期限切れ |
| 発番部署 | 文字列(100) | ○ | 文書発番部署名 |
| 連絡先 | 文字列(100) | - | 問い合わせ先 |
| 備考 | 文字列(500) | - | 補足情報 |
| 作成者ID | 数値 | ○ | 作成ユーザーID |
| 作成日時 | 日時 | ○ | 作成日時 |
| 更新日時 | 日時 | ○ | 最終更新日時 |
| 発信日 | 日付 | ○ | 文書発信日 |
| 公開開始日 | 日付 | ○ | 公開開始日 |
| 公開終了日 | 日付 | - | 公開終了日 |
| 公開範囲 | 文字列(100) | ○ | 部署/グループコード |
| 版番号 | 数値 | ○ | 改訂版番号 |

#### 添付ファイル（PDF）
| 項目 | 型 | 必須 | 説明 |
|------|------|------|------|
| ファイルID | 数値 | ○ | 主キー |
| 文書ID | 数値 | ○ | 外部キー |
| ファイル名 | 文字列(255) | ○ | 元ファイル名 |
| ファイルパス | 文字列(500) | ○ | 保存先パス |
| ファイルサイズ | 数値 | ○ | バイト数 |
| ファイル種別 | 文字列(10) | ○ | PDF/その他 |
| 表示順 | 数値 | ○ | 複数ファイル時の表示順 |
| アップロード日時 | 日時 | ○ | アップロード日時 |

#### ユーザーマスタ
| 項目 | 型 | 必須 | 説明 |
|------|------|------|------|
| ユーザーID | 数値 | ○ | 主キー |
| ログインID | 文字列(50) | ○ | ログインID |
| 氏名 | 文字列(100) | ○ | ユーザー名 |
| 部署コード | 文字列(20) | ○ | 所属部署 |
| 役割 | 文字列(20) | ○ | 閲覧者/投稿者/承認者/管理者 |
| メールアドレス | 文字列(255) | ○ | 通知先メール |

#### 承認履歴
| 項目 | 型 | 必須 | 説明 |
|------|------|------|------|
| 承認ID | 数値 | ○ | 主キー |
| 文書ID | 数値 | ○ | 外部キー |
| 承認者ID | 数値 | ○ | 承認者ユーザーID |
| 承認日時 | 日時 | ○ | 承認実施日時 |
| 承認結果 | 文字列(20) | ○ | 承認/差し戻し |
| コメント | 文字列(500) | - | 承認コメント |

#### 閲覧履歴
| 項目 | 型 | 必須 | 説明 |
|------|------|------|------|
| 履歴ID | 数値 | ○ | 主キー |
| 文書ID | 数値 | ○ | 外部キー |
| ユーザーID | 数値 | ○ | 閲覧者ユーザーID |
| 閲覧日時 | 日時 | ○ | 閲覧日時 |
| 既読フラグ | 真偽値 | ○ | 既読/未読 |

#### 文書版管理
| 項目 | 型 | 必須 | 説明 |
|------|------|------|------|
| 版ID | 数値 | ○ | 主キー |
| 文書ID | 数値 | ○ | 外部キー |
| 版番号 | 数値 | ○ | 版番号 |
| 改訂日時 | 日時 | ○ | 改訂日時 |
| 改訂者ID | 数値 | ○ | 改訂者ユーザーID |
| 改訂内容 | 文字列(500) | - | 改訂内容説明 |
| 旧ファイルパス | 文字列(500) | ○ | 旧版ファイル保存先 |

---

## 7. 画面一覧

### 7.1 文書一覧画面
- カテゴリツリー表示
- 検索条件入力エリア
- 文書一覧テーブル（タイトル、日付、発番部署、文書番号、ステータス）
- ページネーション
- 新規登録ボタン

### 7.2 文書詳細画面
- 文書基本情報表示（文書番号、タイトル、カテゴリ、重要度）
- 発番情報表示（発番部署、発信日、連絡先）
- 公開情報表示（公開期間、公開範囲、ステータス）
- 備考表示
- PDFファイル一覧・ダウンロード・プレビュー
- 版履歴表示
- 既読/未読表示
- 編集ボタン
- 削除ボタン
- 戻るボタン

### 7.3 文書登録・編集画面
- 発番部署選択
- 文書番号入力（発番部署による採番、自動/手動）
- タイトル入力
- カテゴリ選択（通達/連絡/ライブラリ）
- 重要度選択（通常/重要/緊急）
- 連絡先入力
- 発信日選択
- 公開期間設定（開始日/終了日）
- 公開範囲設定（部署/グループ選択）
- 備考入力
- PDFファイルアップロード（複数可、ドラッグ&ドロップ対応）
- 改訂内容入力（編集時）
- 下書き保存ボタン
- 登録/更新ボタン
- キャンセルボタン

### 7.4 承認画面
- 承認待ち文書一覧
- 文書詳細表示
- 承認/差し戻しボタン
- コメント入力欄

### 7.5 管理画面
- ユーザー管理
- 権限設定
- ログ閲覧
- システム設定

---

## 8. 外部インターフェース

### 8.1 認証システム連携
- Active Directory連携
- LDAP認証

### 8.2 メール通知連携
- SMTPサーバー連携
- 通知メール送信

### 8.3 ファイルストレージ連携
- ファイルサーバー連携
- 添付ファイル保存・取得

---

## 9. リニューアル検討事項

### 9.1 UI/UX改善
- モダンなデザイン採用
- レスポンシブ対応強化
- 操作性向上

### 9.2 機能拡張
- 全文検索機能
- タグ機能
- お気に入り機能
- コメント機能
- モバイルアプリ対応

### 9.3 技術刷新
- クラウド対応
- API化
- セキュリティ強化
- パフォーマンス改善

---

## 10. 付録

### 10.1 用語集
- 通達文書: 組織全体への重要な通知文書
- 連絡文書: 部門間の連絡・情報共有文書
- ライブラリ: 参照用の資料・マニュアル等
- ワークフロー: 文書承認の流れ
- 版管理: 文書の更新履歴管理

### 10.2 参考資料
- 既存システムスクリーンショット
- 現行業務フロー図
- ユーザーヒアリング結果

---

**文書履歴**

| 版 | 日付 | 作成者 | 変更内容 |
|----|------|--------|----------|
| 1.0 | 2025年 | - | 初版作成 |
